<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Room Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script>
        async function deleteRoom(room_id) {
            if (!confirm("B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ph√≤ng n√†y?")) return;
            const response = await fetch('/api/rooms/' + room_id, { method: 'DELETE' });
            if (response.ok) {
                const message = await response.text();
                alert(message);
                location.reload();
            } else {
                alert("X√≥a ph√≤ng th·∫•t b·∫°i");
            }
        }
    </script>
</head>

<body class="bg-gray-100 flex">

    <!-- G·ªçi sidebar -->
    <div th:insert="~{fragments/sidebar :: sidebar}"></div>


    <!-- N·ªôi dung trang -->
    <main class="flex-1 p-6 bg-gray-100">


        <h1 class="text-2xl font-bold mb-6">Room Dashboard</h1>

        <!-- N√∫t th√™m ph√≤ng -->
        <div class="mb-4">
            <a href="/dashboard/room/addroom" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">+ Th√™m
                ph√≤ng</a>
        </div>

        <!-- B·∫£ng danh s√°ch ph√≤ng -->
        <!-- B·ªçc to√†n b·ªô b·∫£ng trong m·ªôt div c√≥ gi·ªõi h·∫°n chi·ªÅu ngang -->
        <div class="bg-white rounded shadow overflow-hidden max-w-6xl">
            <table class="min-w-full text-sm">
                <thead class="bg-gray-200 text-left">
                    <tr>
                        <th class="py-2 px-4 ">ID</th>
                        <th class="py-2 px-4 ">T√™n ph√≤ng</th>
                        <th class="py-2 px-4 ">Lo·∫°i</th>
                        <th class="py-2 px-4 ">Gi√°</th>
                        <th class="py-2 px-4 ">M√¥ t·∫£</th> <!-- üëà Gi·ªõi h·∫°n m√¥ t·∫£ -->
                        <th class="py-2 px-4 ">·∫¢nh</th>
                        <th class="py-2 px-4 ">Tr·∫°ng th√°i</th>
                        <th class="py-2 px-4 text-center">H√†nh ƒë·ªông</th>
                    </tr>
                </thead>

                <tbody>
                    <tr th:each="r : ${rooms}" class="hover:bg-gray-50 align-top">
                        <td class="py-2 px-4 border-b " th:text="${r.roomId}"></td>
                        <td class="py-2 px-4 border-b" th:text="${r.roomName}"></td>
                        <td class="py-2 px-4 border-b" th:text="${r.type}"></td>
                        <td class="py-2 px-4 border-b"
                            th:text="${#numbers.formatDecimal(r.price, 1, 'COMMA', 2, 'POINT')}"></td>

                        <!-- üëá M√¥ t·∫£: ·∫©n ph·∫ßn tr√†n + hi·ªÉn th·ªã "..." -->
                        <td class="py-2 px-4 max-w-xs border-b overflow-hidden text-ellipsis line-clamp-3"
                            th:utext="${r.description}">
                        </td>


                        <td class="py-2 px-4 border-b">
                            <img th:src="${r.img}" alt="Room Image" class="w-20 h-16 object-cover rounded">
                        </td>

                        <td class="py-2 px-4 border-b">
                            <span th:if="${r.status.name() == 'available'}"
                                class="text-green-600 font-semibold">Available</span>
                            <span th:if="${r.status.name() == 'deleted'}"
                                class="text-red-600 font-semibold">Deleted</span>
                        </td>

                        <td class="py-2 px-4 border-b space-x-2">
                            <a th:href="@{/dashboard/room/editroom/{id}(id=${r.roomId})}"
                                class="bg-yellow-400 text-white px-3 py-1 rounded hover:bg-yellow-500">
                                ‚úèÔ∏è S·ª≠a
                            </a>
                            <button class="bg-red-600 text-white px-3 py-1 rounded hover:bg-red-700"
                                th:onclick="'deleteRoom(' + ${r.roomId} + ')'">
                                üóëÔ∏è X√≥a
                            </button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>



        <div class="flex justify-center mt-6 space-x-2">
            <!-- N√∫t Prev -->
            <a th:if="${currentPage > 1}" th:href="@{|/dashboard/room/page/${currentPage - 1}|}"
                class="bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">Prev</a>
            <span th:unless="${currentPage > 1}" class="bg-gray-100 text-gray-400 px-3 py-1 rounded">Prev</span>

            <!-- Danh s√°ch trang -->
            <span th:each="i : ${#numbers.sequence(1, totalPages)}">
                <a th:if="${i != currentPage}" th:href="@{|/dashboard/room/page/${i}|}"
                    class="bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">[[${i}]]</a>
                <span th:if="${i == currentPage}" class="bg-blue-500 text-white px-3 py-1 rounded">[[${i}]]</span>
            </span>

            <!-- N√∫t Next -->
            <a th:if="${currentPage < totalPages}" th:href="@{|/dashboard/room/page/${currentPage + 1}|}"
                class="bg-gray-200 px-3 py-1 rounded hover:bg-gray-300">Next</a>
            <span th:unless="${currentPage < totalPages}"
                class="bg-gray-100 text-gray-400 px-3 py-1 rounded">Next</span>
        </div>


    </main>
</body>

</html>